<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Besag-York-Mollié (BYM) model | Kenan Li</title> <meta name="author" content="Kenan Li"> <meta name="description" content="An introduction to BYM model in R with examples"> <meta name="keywords" content="Kenan Li"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img//assets/img/favicon-globe.webp"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://kenan-li.github.io/blog/2023/BYM-Model/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Besag-York-Mollié (BYM) model",
      "description": "An introduction to BYM model in R with examples",
      "published": "April 3, 2023",
      "authors": [
        {
          "author": "Kenan Li",
          "authorURL": "https://www.slu.edu/public-health-social-justice/faculty/li-kenan.php",
          "affiliations": [
            {
              "name": "Saint Louis University",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Kenan </span>Li</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">Research</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Software</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">GRAPH Lab</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/background/">Background</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/blog/">Blog</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/people/">People</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Besag-York-Mollié (BYM) model</h1> <p>An introduction to BYM model in R with examples</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#background">Background</a></div> <div><a href="#application">Application</a></div> <div><a href="#advantages">Advantages</a></div> <div><a href="#implementation-in-r">Implementation in R</a></div> </nav> </d-contents> <h2 id="background">Background</h2> <p>The BYM model, also known as the Besag-York-Mollié model, is a spatial statistical model used for analyzing disease mapping and other spatially structured data. Named after its developers Julian Besag, Jeremy York, and Annie Mollié, it was introduced in their 1991 paper titled “Bayesian Image Restoration, with Two Applications in Spatial Statistics.”</p> <p>The BYM model is a hierarchical Bayesian model that incorporates both spatially structured and unstructured random effects to account for spatial autocorrelation and overdispersion in the data. The model can be represented as:</p> \[Y_i \sim Poisson(E_i * exp(α + U_i + V_i))\quad\quad (1)\] <p>where:</p> <p>$Y_i$ is the observed number of cases in area i $E_i$ is the expected number of cases in area i α is the overall log-relative risk $U_i$ is the spatially unstructured random effect for area i $V_i$ is the spatially structured random effect for area i The spatially structured component ($V_i$) captures the spatial dependence between neighboring areas, while the unstructured component ($U_i$) accounts for any remaining variability not explained by the structured component.</p> <p>It is a special case of the conditional autoregressive (CAR) model. In a CAR model, the response variable in each area is modeled as a linear combination of its neighboring areas, conditional on the values of the response variable in the other areas. This means that the spatial dependence is modeled indirectly through a conditional distribution, and the weights used to define the spatial relationship between areas are conditional on the values of the response variable.</p> <h3 id="application">Application</h3> <p>The BYM model is useful in various applications where spatially structured data is of interest. Here are a few real-world examples where the BYM model can be applied:</p> <p>Disease mapping and epidemiology: The BYM model can be used to analyze the spatial distribution of diseases, identify areas with unusually high or low disease incidence, and estimate relative risks. This information can help public health authorities allocate resources and target interventions more effectively. For example, the BYM model can be applied to study the spatial distribution of cancer cases, malaria, or COVID-19.</p> <p>Environmental risk assessment: The BYM model can be applied to assess environmental risks associated with air pollution, water contamination, or soil pollution. By understanding the spatial patterns of pollutants or hazardous substances, researchers can identify areas with increased risk and inform policy decisions aimed at reducing exposure.</p> <p>Crime analysis: The BYM model can be used to study the spatial distribution of crime incidents and identify hotspots. This information can help law enforcement agencies allocate resources and develop targeted strategies to reduce crime in specific areas.</p> <p>Biodiversity and species distribution: The BYM model can be applied to study the spatial distribution of different species and identify areas with high or low biodiversity. This can help guide conservation efforts, habitat restoration, and wildlife management strategies.</p> <h2 id="advantages">Advantages</h2> <p>Spatial autocorrelation: The BYM model accounts for spatial autocorrelation by incorporating a spatially structured random effect. This enables the model to capture spatial patterns in the data more accurately than non-spatial models.</p> <p>Overdispersion: The BYM model includes an unstructured random effect to account for overdispersion in the data, which is common in count data, such as disease cases or crime incidents.</p> <p>Hierarchical Bayesian framework: The BYM model is a hierarchical Bayesian model, which allows for the incorporation of prior information and provides a coherent framework for uncertainty quantification. This makes the model robust and interpretable.</p> <p>Flexibility: The BYM model is flexible and can be extended to incorporate additional covariates, random effects, or more complex spatial structures. This makes it suitable for a wide range of applications and data types.</p> <h2 id="implementation-in-r">Implementation in R</h2> <p>To illustrate the use of the BYM model in R, we will use the INLA package, which provides an efficient approach to fitting spatial models using Integrated Nested Laplace Approximation (INLA). In this example, we’ll simulate some spatial data and fit the BYM model to it.</p> <p>First, install and load the necessary packages:</p> <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">install.packages</span><span class="p">(</span><span class="s2">"INLA"</span><span class="p">,</span><span class="w"> </span><span class="n">repos</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"https://inla.r-inla-download.org/R/stable"</span><span class="p">,</span><span class="w"> </span><span class="n">getOption</span><span class="p">(</span><span class="s2">"repos"</span><span class="p">)))</span><span class="w">
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"spdep"</span><span class="p">)</span><span class="w">  </span><span class="c1"># For spatial data manipulation</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">INLA</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">spdep</span><span class="p">)</span></code></pre></figure> <p>The following example will show how to create a synthetic spatial dataset, generate the BYM model components, fit the model, and visualize the results:</p> <figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#------------------------------------------------------------------------------</span><span class="w">
</span><span class="c1">#-</span><span class="w">
</span><span class="c1">#-  North Carolina SIDS data</span><span class="w">
</span><span class="c1">#-</span><span class="w">
</span><span class="c1">#-    From Roger Bivand's web site  </span><span class="w">
</span><span class="c1">#-</span><span class="w">
</span><span class="c1">#-    https://r-spatial.github.io/spdep/articles/sids.html</span><span class="w">
</span><span class="c1">#-</span><span class="w">
</span><span class="c1">#------------------------------------------------------------------------------</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="w"> </span><span class="n">spdep</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="w"> </span><span class="n">tmap</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">nc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st_read</span><span class="p">(</span><span class="w"> </span><span class="n">system.file</span><span class="p">(</span><span class="s2">"shapes/sids.shp"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">package</span><span class="o">=</span><span class="s2">"spData"</span><span class="w"> </span><span class="p">)[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">quiet</span><span class="o">=</span><span class="kc">TRUE</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">st_crs</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"+proj=longlat +datum=NAD27"</span><span class="w">
</span><span class="n">row.names</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">nc</span><span class="o">$</span><span class="n">FIPSNO</span><span class="p">)</span><span class="w">
</span><span class="nf">class</span><span class="p">(</span><span class="w"> </span><span class="n">nc</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">nc</span><span class="o">$</span><span class="n">SIDSrate79</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nc</span><span class="o">$</span><span class="n">SID79</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">nc</span><span class="o">$</span><span class="n">BIR79</span><span class="w">


</span><span class="n">tm_shape</span><span class="p">(</span><span class="w"> </span><span class="n">nc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">tm_borders</span><span class="p">(</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">tm_fill</span><span class="p">(</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"SIDSrate79"</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly2nb</span><span class="p">(</span><span class="w"> </span><span class="n">nc</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">nb2INLA</span><span class="p">(</span><span class="w"> </span><span class="s2">"nc.adj"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inla.read.graph</span><span class="p">(</span><span class="w"> </span><span class="n">filename</span><span class="o">=</span><span class="s2">"nc.adj"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">hyperPriors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w"> </span><span class="n">prec.unstruct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">prior</span><span class="o">=</span><span class="s2">"loggamma"</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0.01</span><span class="p">))</span><span class="w"> </span><span class="p">,</span><span class="w">
                    </span><span class="n">prec.spatial</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">prior</span><span class="o">=</span><span class="s2">"loggamma"</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0.01</span><span class="p">))</span><span class="w">  </span><span class="p">)</span><span class="w"> 
</span><span class="n">nc</span><span class="o">$</span><span class="n">NWBIRrate79</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nc</span><span class="o">$</span><span class="n">NWBIR79</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">nc</span><span class="o">$</span><span class="n">BIR79</span><span class="w">

</span><span class="n">nc</span><span class="o">$</span><span class="n">ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span><span class="w">
</span><span class="n">formula</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">SID79</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">NWBIRrate79</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="o">=</span><span class="s2">"bym"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">graph</span><span class="o">=</span><span class="n">g</span><span class="w"> </span><span class="p">,</span><span class="w"> 
                                    </span><span class="n">hyper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hyperPriors</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="n">mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inla</span><span class="p">(</span><span class="w"> </span><span class="n">formula</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="s2">"poisson"</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">nc</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="o">=</span><span class="nf">log</span><span class="p">(</span><span class="n">BIR79</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="w"> </span><span class="n">mod</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="n">mod</span><span class="o">$</span><span class="n">summary.fixed</span><span class="o">$</span><span class="n">mean</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
</span><span class="n">mod</span><span class="o">$</span><span class="n">summary.fixed</span><span class="o">$</span><span class="n">mean</span><span class="p">[</span><span class="m">2</span><span class="p">]</span></code></pre></figure> <p><strong>Figure 1: SIDS Rate 79</strong></p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/BYM_INLA-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/BYM_INLA-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/BYM_INLA-1400.webp"></source> <img src="/assets/img/BYM_INLA.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="SIDS Rate 79" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2018-12-22-distill.bib"></d-bibliography><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"Kenan-Li/personal_website_kl","data-repo-id":"MDEwOlJlcG9zaXRvcnk2MDAyNDM2NQ==","data-category":"Comments","data-category-id":"DIC_kwDOA5PmLc4CTBt6","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Kenan Li. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>